
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>Enhanced AI Agent System - Kultivator</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#enhanced-ai-agent-system" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Kultivator" class="md-header__button md-logo" aria-label="Kultivator" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Kultivator
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Enhanced AI Agent System
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/andjar/Kultivator" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Kultivator" class="md-nav__button md-logo" aria-label="Kultivator" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Kultivator
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/andjar/Kultivator" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#key-components" class="md-nav__link">
    <span class="md-ellipsis">
      Key Components
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Key Components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#agentmanager" class="md-nav__link">
    <span class="md-ellipsis">
      AgentManager
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agentdefinition" class="md-nav__link">
    <span class="md-ellipsis">
      AgentDefinition
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template-system" class="md-nav__link">
    <span class="md-ellipsis">
      Template System
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-agent-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Agent Structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Template Variables
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pre-configured-specialized-agents" class="md-nav__link">
    <span class="md-ellipsis">
      Pre-configured Specialized Agents
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pre-configured Specialized Agents">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#task-manager-task_manager" class="md-nav__link">
    <span class="md-ellipsis">
      Task Manager (task_manager)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#travel-planner-travel_planner" class="md-nav__link">
    <span class="md-ellipsis">
      Travel Planner (travel_planner)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Usage Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Usage Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-agent-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Agent Usage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template-rendering" class="md-nav__link">
    <span class="md-ellipsis">
      Template Rendering
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-specialized-agents" class="md-nav__link">
    <span class="md-ellipsis">
      Using Specialized Agents
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-custom-agents" class="md-nav__link">
    <span class="md-ellipsis">
      Adding Custom Agents
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Adding Custom Agents">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-define-in-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      1. Define in Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-use-the-custom-agent" class="md-nav__link">
    <span class="md-ellipsis">
      2. Use the Custom Agent
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agent-validation" class="md-nav__link">
    <span class="md-ellipsis">
      Agent Validation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Agent Validation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#validation-checks" class="md-nav__link">
    <span class="md-ellipsis">
      Validation Checks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#migration-guide" class="md-nav__link">
    <span class="md-ellipsis">
      Migration Guide
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Migration Guide">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#from-hard-coded-agents" class="md-nav__link">
    <span class="md-ellipsis">
      From Hard-coded Agents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#updating-existing-code" class="md-nav__link">
    <span class="md-ellipsis">
      Updating Existing Code
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-agent-design" class="md-nav__link">
    <span class="md-ellipsis">
      1. Agent Design
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-template-design" class="md-nav__link">
    <span class="md-ellipsis">
      2. Template Design
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-configuration-management" class="md-nav__link">
    <span class="md-ellipsis">
      3. Configuration Management
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#common-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Common Issues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#debug-mode" class="md-nav__link">
    <span class="md-ellipsis">
      Debug Mode
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validation-tool" class="md-nav__link">
    <span class="md-ellipsis">
      Validation Tool
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#future-enhancements" class="md-nav__link">
    <span class="md-ellipsis">
      Future Enhancements
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="enhanced-ai-agent-system">Enhanced AI Agent System</h1>
<p>The Kultivator AI agent system has been significantly improved to provide better flexibility, easier customization, and support for specialized agents. This document describes the new features and how to use them.</p>
<h2 id="overview">Overview</h2>
<p>The enhanced system introduces:</p>
<ol>
<li><strong>Configuration-based agents</strong>: Define agents in <code>config.yaml</code> instead of code</li>
<li><strong>Template system</strong>: Dynamic user prompt generation with variables</li>
<li><strong>Specialized agents</strong>: Pre-configured agents for specific domains (tasks, travel, etc.)</li>
<li><strong>Agent validation</strong>: Validate agent definitions for correctness</li>
<li><strong>Backward compatibility</strong>: Existing code continues to work</li>
</ol>
<h2 id="key-components">Key Components</h2>
<h3 id="agentmanager">AgentManager</h3>
<p>Central manager for configuration-based agents with template support.</p>
<h3 id="agentdefinition">AgentDefinition</h3>
<p>Data structure representing a complete agent configuration loaded from YAML.</p>
<h3 id="template-system">Template System</h3>
<p>Dynamic prompt generation using Python's <code>str.format()</code> method with <code>{variable}</code> syntax.</p>
<h2 id="configuration">Configuration</h2>
<h3 id="basic-agent-structure">Basic Agent Structure</h3>
<pre><code class="language-yaml">agents:
  definitions:
    my_agent:
      description: &quot;Brief description of the agent&quot;
      system_prompt: |
        Multi-line system prompt that defines the agent's role,
        capabilities, and behavior guidelines.
      user_prompt_template: |
        Template for user prompts with {variables} that will be
        replaced with actual values at runtime.
      available_tools: [&quot;list_entities&quot;, &quot;get_entity_context&quot;]
      requires_database: true
      timeout: 30.0
</code></pre>
<h3 id="template-variables">Template Variables</h3>
<p>Common template variables available:</p>
<ul>
<li><code>{content}</code>: Raw content from the block</li>
<li><code>{entity_name}</code>: Name of the entity being processed</li>
<li><code>{entity_type}</code>: Type of entity (person, project, etc.)</li>
<li><code>{source_ref}</code>: Reference to the source block</li>
<li><code>{created_at}</code>: Creation timestamp</li>
<li><code>{updated_at}</code>: Last updated timestamp</li>
<li><code>{current_time}</code>: Current processing time</li>
<li><code>{context_info}</code>: Knowledge base context</li>
<li><code>{existing_content}</code>: Existing content for merge operations</li>
<li><code>{summary}</code>: Summary of new information</li>
</ul>
<h2 id="pre-configured-specialized-agents">Pre-configured Specialized Agents</h2>
<h3 id="task-manager-task_manager">Task Manager (<code>task_manager</code>)</h3>
<p>Specialized for organizing and tracking tasks and project information.</p>
<p><strong>Capabilities:</strong>
- Extract tasks, deadlines, and priorities
- Identify project dependencies and relationships
- Create structured task lists and project overviews
- Track task status and progress
- Suggest task categorization and prioritization</p>
<p><strong>Use cases:</strong>
- Project management notes
- Task tracking and organization
- Deadline management
- Progress tracking</p>
<h3 id="travel-planner-travel_planner">Travel Planner (<code>travel_planner</code>)</h3>
<p>Specialized for travel information organization and itinerary planning.</p>
<p><strong>Capabilities:</strong>
- Extract travel dates, destinations, and activities
- Create structured itineraries and travel plans
- Identify travel-related entities (places, accommodations, activities)
- Organize travel information by trip or destination
- Track travel expenses and bookings</p>
<p><strong>Use cases:</strong>
- Travel planning and itineraries
- Trip organization
- Travel expense tracking
- Destination information management</p>
<h2 id="usage-examples">Usage Examples</h2>
<h3 id="basic-agent-usage">Basic Agent Usage</h3>
<pre><code class="language-python">from kultivator.agents import agent_manager, AgentRunner

# List available agents
agents = agent_manager.list_agents()
print(&quot;Available agents:&quot;, agents)

# Get agent definition
agent_def = agent_manager.get_agent_definition(&quot;task_manager&quot;)
print(&quot;Description:&quot;, agent_def.description)

# Validate agent
validation = agent_manager.validate_agent_definition(&quot;task_manager&quot;)
if validation['valid']:
    print(&quot;Agent is valid&quot;)
else:
    print(&quot;Errors:&quot;, validation['errors'])
</code></pre>
<h3 id="template-rendering">Template Rendering</h3>
<pre><code class="language-python"># Render a user prompt
template_vars = {
    'content': 'Meeting with John about project deadlines',
    'entity_name': 'Project Alpha',
    'entity_type': 'project',
    'source_ref': 'notes/2024-01-15.md'
}

prompt = agent_manager.render_user_prompt(&quot;task_manager&quot;, **template_vars)
print(&quot;Rendered prompt:&quot;, prompt)
</code></pre>
<h3 id="using-specialized-agents">Using Specialized Agents</h3>
<pre><code class="language-python">from kultivator.agents.runner import AgentRunner
from kultivator.models import Entity, CanonicalBlock

# Create test data
entity = Entity(name=&quot;European Trip&quot;, entity_type=&quot;travel&quot;)
block = CanonicalBlock(
    block_id=&quot;travel-1&quot;,
    content=&quot;Flight to Paris on March 15, hotel booking at Hotel Louvre&quot;,
    source_ref=&quot;travel/europe-2024.md&quot;,
    created_at=1234567890,
    updated_at=1234567890
)

# Run specialized agent
runner = AgentRunner(database_manager=db)
content = runner.run_specialized_agent(
    &quot;travel_planner&quot;,
    entity,
    &quot;New travel information&quot;,
    block
)
print(&quot;Generated content:&quot;, content)
</code></pre>
<h2 id="adding-custom-agents">Adding Custom Agents</h2>
<h3 id="1-define-in-configuration">1. Define in Configuration</h3>
<p>Add to <code>config.yaml</code>:</p>
<pre><code class="language-yaml">agents:
  definitions:
    finance_manager:
      description: &quot;Manages financial information and expense tracking&quot;
      system_prompt: |
        You are a financial management assistant. Your role is to organize
        financial information, track expenses, and provide financial insights.

        Your capabilities:
        1. Extract financial data from notes
        2. Categorize expenses and income
        3. Create financial summaries and reports
        4. Track budgets and financial goals
        5. Identify financial trends and patterns

        Always provide clear, accurate financial information in Markdown format.
      user_prompt_template: |
        Analyze this financial content:

        Content: {content}
        Source: {source_ref}
        Entity Name: {entity_name}
        Entity Type: {entity_type}

        KNOWLEDGE BASE CONTEXT:
        {context_info}

        Create a structured financial page with:
        - Income and expense categorization
        - Budget tracking
        - Financial goals and progress
        - Spending patterns and insights
      available_tools: [&quot;list_entities&quot;, &quot;get_entity_context&quot;]
      requires_database: true
      timeout: 30.0
</code></pre>
<h3 id="2-use-the-custom-agent">2. Use the Custom Agent</h3>
<pre><code class="language-python"># The agent is automatically available after config reload
agent_manager.reload_definitions()

# Validate the new agent
validation = agent_manager.validate_agent_definition(&quot;finance_manager&quot;)
if validation['valid']:
    print(&quot;Custom agent is ready to use!&quot;)

# Use the agent
runner = AgentRunner(database_manager=db)
content = runner.run_specialized_agent(
    &quot;finance_manager&quot;,
    entity,
    &quot;Monthly expenses summary&quot;,
    block
)
</code></pre>
<h2 id="agent-validation">Agent Validation</h2>
<p>The system includes comprehensive validation:</p>
<pre><code class="language-python"># Validate an agent definition
validation = agent_manager.validate_agent_definition(&quot;my_agent&quot;)

print(&quot;Valid:&quot;, validation['valid'])
print(&quot;Errors:&quot;, validation['errors'])
print(&quot;Warnings:&quot;, validation['warnings'])
</code></pre>
<h3 id="validation-checks">Validation Checks</h3>
<ul>
<li><strong>Required fields</strong>: Description, system_prompt, user_prompt_template</li>
<li><strong>Empty prompts</strong>: System prompt and template cannot be empty</li>
<li><strong>Template variables</strong>: Checks for recommended variables</li>
<li><strong>Tool availability</strong>: Warns about unknown tools</li>
<li><strong>Timeout values</strong>: Must be positive</li>
<li><strong>Agent existence</strong>: Verifies agent exists in configuration</li>
</ul>
<h2 id="migration-guide">Migration Guide</h2>
<h3 id="from-hard-coded-agents">From Hard-coded Agents</h3>
<p>Old approach:</p>
<pre><code class="language-python"># Hard-coded in registry.py
agent_registry.register_agent(AgentConfig(
    name=&quot;my_agent&quot;,
    description=&quot;My agent&quot;,
    system_prompt=&quot;You are my agent...&quot;,
    # ... other config
))
</code></pre>
<p>New approach:</p>
<pre><code class="language-yaml"># In config.yaml
agents:
  definitions:
    my_agent:
      description: &quot;My agent&quot;
      system_prompt: &quot;You are my agent...&quot;
      user_prompt_template: &quot;Process: {content}&quot;
      # ... other config
</code></pre>
<h3 id="updating-existing-code">Updating Existing Code</h3>
<p>The new system is backward compatible. Existing code will continue to work, but you can gradually migrate to the new system:</p>
<ol>
<li>Move agent definitions from code to <code>config.yaml</code></li>
<li>Use <code>agent_manager</code> instead of <code>agent_registry</code> for new features</li>
<li>Leverage template system for dynamic prompts</li>
<li>Use specialized agents where appropriate</li>
</ol>
<h2 id="best-practices">Best Practices</h2>
<h3 id="1-agent-design">1. Agent Design</h3>
<ul>
<li><strong>Clear purpose</strong>: Each agent should have a specific, well-defined purpose</li>
<li><strong>Comprehensive prompts</strong>: Include detailed instructions and examples</li>
<li><strong>Proper tools</strong>: Only include tools the agent actually needs</li>
<li><strong>Reasonable timeouts</strong>: Set appropriate timeouts for agent complexity</li>
</ul>
<h3 id="2-template-design">2. Template Design</h3>
<ul>
<li><strong>Descriptive variables</strong>: Use clear, descriptive variable names</li>
<li><strong>Consistent format</strong>: Maintain consistent template structure</li>
<li><strong>Required vs optional</strong>: Clearly distinguish required from optional variables</li>
<li><strong>Fallback handling</strong>: Consider what happens with missing variables</li>
</ul>
<h3 id="3-configuration-management">3. Configuration Management</h3>
<ul>
<li><strong>Version control</strong>: Keep config.yaml in version control</li>
<li><strong>Validation</strong>: Always validate agents after configuration changes</li>
<li><strong>Documentation</strong>: Document custom agents and their intended use</li>
<li><strong>Testing</strong>: Test custom agents thoroughly before deployment</li>
</ul>
<h2 id="troubleshooting">Troubleshooting</h2>
<h3 id="common-issues">Common Issues</h3>
<ol>
<li><strong>Template rendering errors</strong>: Check variable names and availability</li>
<li><strong>Agent not found</strong>: Verify agent name in configuration</li>
<li><strong>Validation failures</strong>: Check required fields and syntax</li>
<li><strong>Import errors</strong>: Ensure proper imports and module structure</li>
</ol>
<h3 id="debug-mode">Debug Mode</h3>
<p>Enable debug logging to see detailed agent execution:</p>
<pre><code class="language-python">import logging
logging.basicConfig(level=logging.DEBUG)

# Now run your agent code
</code></pre>
<h3 id="validation-tool">Validation Tool</h3>
<p>Use the validation tool to check agent definitions:</p>
<pre><code class="language-python">from kultivator.agents import agent_manager

# Validate all agents
for agent_name in agent_manager.list_agents():
    validation = agent_manager.validate_agent_definition(agent_name)
    if not validation['valid']:
        print(f&quot;Agent {agent_name} has issues:&quot;)
        for error in validation['errors']:
            print(f&quot;  Error: {error}&quot;)
        for warning in validation['warnings']:
            print(f&quot;  Warning: {warning}&quot;)
</code></pre>
<h2 id="future-enhancements">Future Enhancements</h2>
<p>The new system provides a foundation for future enhancements:</p>
<ol>
<li><strong>Multi-language support</strong>: Different prompts for different languages</li>
<li><strong>Agent plugins</strong>: Pluggable agent systems</li>
<li><strong>Advanced templates</strong>: More sophisticated templating features</li>
<li><strong>Agent chaining</strong>: Chain multiple agents together</li>
<li><strong>Performance optimization</strong>: Caching and optimization features</li>
</ol>
<h2 id="conclusion">Conclusion</h2>
<p>The enhanced AI agent system provides a more flexible, maintainable, and extensible approach to AI agent management in Kultivator. By moving configuration out of code and into YAML files, users can easily customize and extend the system without modifying the codebase.</p>
<p>The specialized agents (task management, travel planning) demonstrate the power of this approach, while the template system enables dynamic prompt generation for various use cases.</p>
<p>This system maintains backward compatibility while providing a clear path forward for future enhancements and customizations.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
    
  </body>
</html>